<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>예약 정보</title>
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="../css/login.css">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    
    
    <script src="../lib/jquery-3.6.0.min.js"></script>
    
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script type='text/javascript'>

    function showData(ArrivalName, StationLocation)
    {
        let xhttp = new XMLHttpRequest();
        winodw.alert()
        xhttp.onreadystatechange = function () {
            if(xhttp.readyState == 4 && xhttp.status == 200){
                //jsonfunc(this.responseText);
                jsonfunc(xhttp.responseText);
            }
        }
        
        xhttp.open("GET","http://ec2-43-201-47-225.ap-northeast-2.compute.amazonaws.com:81/attractions");
        //window.alert("http://ec2-43-201-47-225.ap-northeast-2.compute.amazonaws.com:81/attraction?location=" + ArrivalName + "&stationName=" + stationLocation)
        xhttp.send();
        let txt = "";

        function jsonfunc( jsonText ) {
            let json = JSON.parse(jsonText); // String -> json으로 변환
            //let txt = "";
            for (let i = 0; i < json.length; i++)
            {
                txt += "<div class='place_area row' style='display: inline-block;'>";
                txt += json[i]['attrName'];
                txt += "</div>";

            }
            document.getElementById("near_station").innerHTML = txt;
        }
    }

        function resv_detail() 
        {
            //const arrive = document.getElementById('ep');
            let xhttp = new XMLHttpRequest();

            xhttp.onreadystatechange = function () {
                if(xhttp.readyState == 4 && xhttp.status == 200){
                    //jsonfunc(this.responseText);
                    jsonfunc(xhttp.responseText);
                }
            }
            
            xhttp.open("GET","http://ec2-43-201-47-225.ap-northeast-2.compute.amazonaws.com:81/route/all");
            
            xhttp.send();
            let txt = "";

            function jsonfunc( jsonText ) {

                let json = JSON.parse(jsonText); // String -> json으로 변환
                //let txt = "";

                for (let i = 0; i < json.length; i++)
                {
                    txt += "<div class='place_area row' style='display: inline-block;'>";
                    txt += json[i]['attrName'];
                    txt += "</div>";
                    //window.alert(arrive +  " " + json["arrivalName"]);
                }
                document.getElementById("near_station").innerHTML = txt;
            }
        
        }

        function resv_detail2(ArrivalName, StationLocation) 
        {
            //const arrive = document.getElementById('ep');
            let xhttp = new XMLHttpRequest();

            xhttp.onreadystatechange = function () {
                if(xhttp.readyState == 4 && xhttp.status == 200){
                    //jsonfunc(this.responseText);
                    jsonfunc(xhttp.responseText);
                }
            }
            
            xhttp.open("GET","http://ec2-43-201-47-225.ap-northeast-2.compute.amazonaws.com:81/route/all");
            
            xhttp.send();
            let txt = "";
            
            function jsonfunc( jsonText ) {
                let json = JSON.parse(jsonText); // String -> json으로 변환
                //let txt = "";
                window.alert(jsonText);
                for (let i = 0; i < json.length; i++)
                {
                    window.alert(StationLocation + " " + json[i]['arrivalName'])
                    if (StationLocation === json[i]["stationLocation"] && ArrivalName === json[i]["arrivalName"])
                    {
                        showData(ArrivalName, StationLocation);
                        //txt += "<div class='place_area row' style='display: inline-block;'>";
                        //txt += json[i]['attrName'];
                        //txt += "</div>";
                    }
                    //window.alert(arrive +  " " + json["arrivalName"]);
                }
                document.getElementById("near_station").innerHTML = txt;
            }
        
        }

        function start_function()
        {
            const End = document.getElementById('start_points');
            let xhttp = new XMLHttpRequest();
            
            xhttp.onreadystatechange = function () {
                if(xhttp.readyState == 4 && xhttp.status == 200){
                    //jsonfunc(this.responseText);
                    jsonfunc(xhttp.responseText);
                }
            }
            xhttp.open("GET","http://ec2-43-201-47-225.ap-northeast-2.compute.amazonaws.com:81/route/all");
            xhttp.send();

            function jsonfunc( jsonText ) {
                let json = JSON.parse(jsonText); // String -> json으로 변환
                let txt = "";
                txt += `<a class="dropdown-item" style="display: block;" href="#" id="ep" onclick="changePlace(출발지 선택);">출발지 선택</a>`;
                
                for (let i = 0; i < json.length; i++)
                {
                    let flag = 0;
                    for (let j = i + 1; j < json.length; j++)
                    {
                        if (json[i]['arrivalName'] === json[j]['arrivalName'])
                            flag = 1;
                    }

                    if (flag)
                        continue;
                    
                    txt += `<a class="dropdown-item" style="display: block;" href="#" id="sp"`;
                    txt += `onclick="changePlace('`;
                    txt += json[i]['departureName'];
                    txt += `'); ">`;
                    txt += json[i]['departureName'];
                    txt += "</a>";
                }
                document.getElementById("start_points").innerHTML = txt;
            }
        }

        function end_function()
        {
            const End = document.getElementById('end_points');
            let xhttp = new XMLHttpRequest();

            xhttp.onreadystatechange = function () {
                if(xhttp.readyState == 4 && xhttp.status == 200){
                    //jsonfunc(this.responseText);
                    jsonfunc(xhttp.responseText);
                }
            }
            xhttp.open("GET","http://ec2-43-201-47-225.ap-northeast-2.compute.amazonaws.com:81/route/all");
            xhttp.send();

            function jsonfunc( jsonText ) {
            
                let json = JSON.parse(jsonText); // String -> json으로 변환
                let txt = "";
                txt += `<a class="dropdown-item" style="display: block;" href="#" id="ep" onclick="changePlace(도착지 선택); resv_detail();">도착지 선택</a>`;
                
                for (let i = 0; i < json.length; i++)
                {
                    let flag = 0;
                    for (let j = i + 1; j < json.length; j++)
                    {
                        if (json[i]['arrivalName'] === json[j]['arrivalName'])
                        flag = 1;
                    }
                    
                    if (flag)
                        continue;
                    
                    txt += `<a class="dropdown-item" style="display: block;" href="#" id="ep"`;
                    txt += `onclick="changePlace2('`;
                    txt += json[i]['arrivalName'];
                    txt += `'); resv_detail2('`; 
                    txt += json[i]['arrivalName']; 
                    txt += "','";
                    txt += json[i]['stationLocation'];
                    txt += `');resv_detail(`;
                    txt += json[i]['arrivalName'];
                    txt += `);">`;
                    txt += json[i]['arrivalName'];
                    txt += "</a>";
                }
                document.getElementById("end_points").innerHTML = txt;
            }
        }

        function changeMenu(price)
        {
            document.getElementById("near_station").innedrHTML = "";
            const selected = document.getElementById('navbarDropdown');
            selected.innerHTML = price; 
        }

        function changeMenu2(num_of_bags)
        {
            document.getElementById("near_station").innerHTML = "";
            const selected = document.getElementById('navbarDropdown2');
            selected.innerHTML = num_of_bags;
        }

        function changePlace(place)
        {
            document.getElementById("near_station").innerHTML = "";
            const selected = document.getElementById('place_type');
            selected.innerHTML = place;
        }

        function changePlace2(place)
        {
            document.getElementById("near_station").innerHTML = "";
            const selected = document.getElementById('place_type2');
            selected.innerHTML = place;
        }
    </script>
</head>

<style>
    .header {
        display: flex;
        max-width: 100%;
        height: 200px; 
        background-color: lightgray;
        justify-content: center;
        align-items: center;
    }

    .my_body {
        margin-top: 50px;
        font-family: 'Noto Sans KR', sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .my_area {
        padding: 50px;
        display: inline-block;
        vertical-align: top;
    }

    .my_element {
        display: inline-block;
    }

    .my_text {
        display: inline-block;
        margin-right: 10px;
    }

    .pos_point {
        height: 200px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .form-control {
        resize: none;
    }

    .drop_down_area {
        height: 400px; 
        display: flex; 
        align-items:center; 
    }

    .place_area {
        height: 200px;
        border: solid;
        margin: 10px;
        width : 350px;
    }
</style>

<!--Header_section-->
<header id="header_wrapper">
    <div class="container">
        <div class="header_box">
            <div class="logo"><a href="#"><img src="img/logo.png" alt="logo"></a></div>
            <nav class="navbar navbar-inverse" role="navigation">
                <div class="navbar-header">
                    <button type="button" id="nav-toggle" class="navbar-toggle" data-toggle="collapse"
                        data-target="#main-nav"> <span class="sr-only">Toggle navigation</span> <span
                            class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
                    </button>
                </div>
                <div id="main-nav" class="collapse navbar-collapse navStyle">
                    <ul class="navbar" id="mainNav">
                        <li class="active"><a href="main.html" class="scroll-link">홈</a></li>
                        <li><a href="place.html" class="scroll-link">관광지</a></li>
                        <li><a href="reserve.html" class="scroll-link">예약하기</a></li>
                        <li><a href="card.html" class="scroll-link">카드</a></li>
                        <li><a href="login.html" class="scroll-link">Login | Signup</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>
</header>
<!--Header_section-->

<body>
    <input type="hidden" id="서울" value="서울">
    <input type="hidden" id="대전" value="대전">
    <div class="my_body">
        <div class="row col-md-4 col-sm-4 my_area">
            <img src="train.png" alt="example" class="my_area">
            <p>소개</p>
            <div class="form-outline">
                <textarea class="form-control my_text" id="textArea1" rows="10" readonly>
저기 사라진 별의 자리 &#10;아스라이 하얀 빛
한동안은 꺼내 볼 수 있을 거야
아낌없이 반짝인 시간은
조금씩 옅어져 가더라도
너와 내 맘에 살아 숨 쉴 테니
                </textarea>
            </div>
        </div>
        <div class="row col-md-4 col-sm-4 my_area">
            <img src="route.png" alt="example">
            <div class="pos_point nav-item dropdown">
                <div class="drop_down_area my_text">
                    <button class="btn btn-area nav-link dropdown-toggle" style="width: 200px !important; font-size: 20px;" href="#" id="place_type" role="button" data-toggle="dropdown" aria-haspopup="true">
                        출발지 선택
                    </button>
                    <div id="start_points" class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="font-size: 20px;">
                        <script>start_function()</script>
                    </div>
                </div>
                
                <div class="drop_down_area my_text">
                    <button class="btn btn-area nav-link dropdown-toggle" style="width: 200px !important; font-size: 20px;" href="#" id="place_type2" role="button" data-toggle="dropdown" aria-haspopup="true">
                        도착지 선택
                    </button>
                    <div id="end_points" class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink" style="font-size: 20px;">
                        <script>end_function()</script>
                    </div>
                </div>
            </div>
        </div>
        <div class="row col-md-4 col-sm-4 my_area">
            <p id="start_time">출발 시간 :</p>
            <p id="end_time">도착 시간 :</p>
            <div class="drop_down_area">
                <div class="nav-item dropdown">
                    <button class="btn btn-area nav-link dropdown-toggle" style="width: 200px !important; font-size: 20px;" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true">
                        클래스(가격) 선택
                    </button>
                    <div class="dropdown-menu" id="method_type" aria-labelledby="navbarDropdownMenuLink" style="font-size: 20px;">
                        <a class="dropdown-item" style="display: block;;" href="#" id="price0" onclick="changeMenu('클래스(가격) 선택')">클래스(가격) 선택</a>
                        <a class="dropdown-item" style="display: block;" href="#" id="price1" onclick="changeMenu('10000원')">10000원</a>
                        <a class="dropdown-item" style="display: block;" href="#" id="price2" onclick="changeMenu('20000원')">20000원</a>
                        <a class="dropdown-item" style="display: block;" href="#" id="price3" onclick="changeMenu('30000원')">30000원</a>
                    </div>
                </div>
                <div class="nav-item dropdown">
                    <button class="btn btn-area nav-link dropdown-toggle" style="width: 200px !important; font-size: 20px;" href="#" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true">
                        가방수 선택
                    </button>
                    <div class="dropdown-menu" id="method_type" aria-labelledby="navbarDropdownMenuLink" style="font-size: 20px;">
                        <a class="dropdown-item" style="display: block;" href="#" id="price0" onclick="changeMenu2('가방수 선택')">가방수 선택</a>
                        <a class="dropdown-item" style="display: block;" href="#" id="price1" onclick="changeMenu2('1')">1</a>
                        <a class="dropdown-item" style="display: block;" href="#" id="price2" onclick="changeMenu2('2')">2</a>
                    </div>
                </div>
            </div>
            <div class="row"><button class="btn btn-info" type="submit" style="font-size: 20px;">예약 완료</button></div>
        </div>

    </div>
    <div class="row">
        <div id="near_station" style="font-size: 20px; align-items: center; text-align: center;">
                
        </div>
    </div>
</body>

</html>